<!DOCTYPE html>
<html>
<head lang="en">
	<meta charset="UTF-8">
	<title></title>
<style>
</style>
</head>

<body>


<gallery [gallery-type]="abc">
	<img src="1px.dom.js"/>
	<img src="1px.dom.js"/>
	<img src="1px.dom.js"/>
	<img src="1px.dom.js"/>
</gallery>

<script>
var getInlineHTML = function(window, document) {

	function foreach(arr, fn) {
		if (!arr) return;
		for (var i = 0, len = arr.length; i < len; i++) {
			fn(arr[i], i);
		}
	}

	function cssToInlineHTML(document) {
		foreach(document.styleSheets, function(styleSheet) {
			var rules = styleSheet.rules || styleSheet.cssRules;
			foreach(rules, function(rule) {
				try {
					foreach(document.querySelectorAll(rule.selectorText), function(el) {
						el.style.cssText += rule.style.cssText;
					});
				} catch(e){}
			});
		});
	}

	return function(html) {
		var index = html.lastIndexOf("</html>");
		if (index !== -1) {
			html = html.substring(0, index);
		}

		var iframe = document.createElement("iframe");
		document.body.appendChild(iframe);

		var doc = iframe.contentWindow.document;
		doc.write(html);
		cssToInlineHTML(doc);

		var result = doc.body.innerHTML;
		document.body.removeChild(iframe);
		return result;
	}
}(window, document);


var http = new XMLHttpRequest();
http.open("GET", "clip.html");
http.onload = function(e) {
	var html = this.responseText;
	html = getInlineHTML(html);
	console.log(html);
};
http.send();


</script>

</body>
</html>