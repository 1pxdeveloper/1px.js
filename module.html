<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="js4/observable.js"></script>
    <script src="js4/watch.js"></script>
    <script src="js4/module.js"></script>
    <script src="js4/parse.js"></script>
    <script src="js4/compile.js"></script>
</head>
<body>


<h1>{{ title }}</h1>

<h2>{{ c$ }}</h2>

<ul>
    <li *repeat="arr as a, index">hello~~ {{ a }} {{ index }}</li>
</ul>

<script>
	let b = document.body;

	b.title = "asdflkjaslkdfjlksadfas";

	b.arr = ["A"];

	// b.c$ = Observable.interval(500).map(i => i);


	// $compile(b);


	let A = "abcde".split("");

	let container = A.map(v => {
		let ret = document.createElement("span");
		ret.innerText = v;

		return {
			node: ret,
			value: v
		}
	});

	container.forEach(b => {
		document.body.appendChild(b.node);
	});

	let placehodlerEnd = document.createComment("");
	document.body.appendChild(placehodlerEnd);


	let B = "abde".split("");

	let [c, d, e] = LCS(A, B);


	console.log(c, d, e);

	// console.log(c, d, e);


	let dels = [];
	let placeholders = [];
	let _container = [];

	A.forEach((value, index) => {
		if (!d[index]) {
			_container[index] = value;
			dels.push(container[index]);
			container[index].node.remove();
		} else {
			placeholders.push(container[index].node);
		}
	});
	placeholders.push(placehodlerEnd);


	console.log("dels", dels);
	console.log("placeholders", placeholders);


	////
	let placeholder_index = 0;
	let placeholder = placeholders[placeholder_index];

	let _new_container = B.map((value, index) => {
		if (!e[index]) {
			let idx = _container.indexOf(value);

			let r = container[idx];
			if (r) {
				r = r.node;
				r.style.color = "red";
				delete container[idx];
			}

			if (!r) {
				r = document.createElement("strong");
				r.innerText = value;
			}

			placeholder.before(r);
			return {
				node: r,
				value: value,
				index: index
			}
		}

		placeholder = placeholders[++placeholder_index];
		return {
			node: placeholder,
			value: value,
			index: index
		}
	});


	console.log("_container", _container);
	console.log("_new_container", _new_container);


</script>

</body>
</html>